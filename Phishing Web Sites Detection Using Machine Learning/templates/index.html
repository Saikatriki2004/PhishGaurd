<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhishGuard - URL Security Scanner</title>
    <meta name="description" content="Detect phishing websites with AI-powered URL analysis">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #eef2ff 0%, #f8fafc 100%);
            min-height: 100vh;
            color: #1e293b;
        }

        /* =========================================
           NAVIGATION BAR
        ========================================= */
        .navbar {
            background: #ffffff;
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: #1e293b;
            text-decoration: none;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-icon svg {
            width: 22px;
            height: 22px;
            color: white;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #64748b;
            font-weight: 500;
            font-size: 0.9rem;
            transition: color 0.2s;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: #4f46e5;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
            background: transparent;
            border: none;
        }

        .nav-icon:hover {
            background: #f1f5f9;
        }

        .nav-icon svg {
            width: 22px;
            height: 22px;
            color: #64748b;
        }

        .avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .avatar svg {
            width: 24px;
            height: 24px;
            color: white;
        }

        /* =========================================
           HERO SECTION
        ========================================= */
        .hero {
            background: linear-gradient(180deg, #eef2ff 0%, #f8fafc 100%);
            padding: 4rem 2rem 3rem;
            text-align: center;
        }

        .hero h1 {
            font-size: 2.75rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .hero h1 span {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            color: #64748b;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto 2rem;
            line-height: 1.7;
        }

        /* =========================================
           SEARCH BAR
        ========================================= */
        .search-container {
            max-width: 700px;
            margin: 0 auto 1.5rem;
        }

        .search-box {
            display: flex;
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 4px 25px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }

        .search-input-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            padding: 0 1.25rem;
            gap: 0.75rem;
        }

        .search-input-wrapper svg {
            width: 20px;
            height: 20px;
            color: #94a3b8;
            flex-shrink: 0;
        }

        .search-input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 1rem;
            padding: 1.25rem 0;
            font-family: inherit;
            color: #1e293b;
        }

        .search-input::placeholder {
            color: #94a3b8;
        }

        .scan-btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 1rem 1.75rem;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: opacity 0.2s, transform 0.1s;
            margin: 0.5rem;
            border-radius: 12px;
        }

        .scan-btn:hover {
            opacity: 0.95;
        }

        .scan-btn:active {
            transform: scale(0.98);
        }

        .scan-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .scan-btn svg {
            width: 18px;
            height: 18px;
        }

        .badges {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #64748b;
            font-size: 0.85rem;
        }

        .badge svg {
            width: 16px;
            height: 16px;
        }

        .badge.green svg {
            color: #22c55e;
        }

        .badge.blue svg {
            color: #3b82f6;
        }

        /* =========================================
           MAIN CONTENT
        ========================================= */
        .main-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 2rem 3rem;
        }

        /* =========================================
           LOADING STATE
        ========================================= */
        .loading-overlay {
            display: none;
            padding: 3rem 2rem;
            text-align: center;
        }

        .loading-overlay.active {
            display: block;
        }

        .spinner-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #e2e8f0;
            border-top-color: #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            color: #4f46e5;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .loading-subtext {
            color: #94a3b8;
            font-size: 0.9rem;
        }

        /* =========================================
           RESULT SECTION
        ========================================= */
        .result-section {
            display: none;
        }

        .result-section.active {
            display: block;
        }

        /* Verdict Card */
        .verdict-card {
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .verdict-card.safe {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 1px solid #86efac;
        }

        .verdict-card.suspicious {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border: 1px solid #fcd34d;
        }

        .verdict-card.phishing {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border: 1px solid #fca5a5;
        }

        .verdict-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .verdict-icon.safe {
            background: #22c55e;
        }

        .verdict-icon.suspicious {
            background: #f59e0b;
        }

        .verdict-icon.phishing {
            background: #ef4444;
        }

        .verdict-icon svg {
            width: 36px;
            height: 36px;
            color: white;
        }

        .verdict-content {
            flex: 1;
        }

        .verdict-text {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .verdict-text.safe {
            color: #16a34a;
        }

        .verdict-text.suspicious {
            color: #d97706;
        }

        .verdict-text.phishing {
            color: #dc2626;
        }

        .verdict-subtext {
            color: #64748b;
            font-size: 0.95rem;
        }

        .trusted-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: #dcfce7;
            border: 1px solid #86efac;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            margin-top: 0.75rem;
            font-size: 0.85rem;
            font-weight: 500;
            color: #16a34a;
        }

        .trusted-badge svg {
            width: 16px;
            height: 16px;
        }

        /* Risk Assessment */
        .risk-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #f1f5f9;
        }

        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .risk-label {
            font-size: 0.8rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .risk-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .risk-value.safe {
            color: #22c55e;
        }

        .risk-value.suspicious {
            color: #f59e0b;
        }

        .risk-value.phishing {
            color: #ef4444;
        }

        .risk-bar {
            height: 8px;
            background: #f1f5f9;
            border-radius: 4px;
            overflow: hidden;
        }

        .risk-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease-out;
        }

        .risk-bar-fill.safe {
            background: linear-gradient(90deg, #22c55e, #4ade80);
        }

        .risk-bar-fill.suspicious {
            background: linear-gradient(90deg, #f59e0b, #fbbf24);
        }

        .risk-bar-fill.phishing {
            background: linear-gradient(90deg, #ef4444, #f87171);
        }

        .risk-level-text {
            font-size: 0.85rem;
            color: #64748b;
            margin-top: 0.5rem;
        }

        /* Warning Boxes */
        .warning-box {
            padding: 1rem 1.25rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .warning-box.incomplete {
            background: #fffbeb;
            border: 1px solid #fcd34d;
        }

        .warning-box.allowlist {
            background: #f0fdf4;
            border: 1px solid #86efac;
        }

        .warning-box svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .warning-box.incomplete svg {
            color: #f59e0b;
        }

        .warning-box.allowlist svg {
            color: #22c55e;
        }

        .warning-content h4 {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .warning-box.incomplete h4 {
            color: #d97706;
        }

        .warning-box.allowlist h4 {
            color: #16a34a;
        }

        .warning-content p {
            font-size: 0.85rem;
            color: #64748b;
        }

        /* Signals Section */
        .signals-section {
            background: #ffffff;
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #f1f5f9;
        }

        .signals-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .signals-header svg {
            width: 20px;
            height: 20px;
            color: #4f46e5;
        }

        .signals-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e293b;
        }

        .signals-summary {
            padding: 1rem;
            background: #f8fafc;
            border-radius: 10px;
            margin-bottom: 1rem;
            color: #475569;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .signal-group {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 0.75rem;
        }

        .signal-group.positive {
            background: #f0fdf4;
            border-left: 4px solid #22c55e;
        }

        .signal-group.risk {
            background: #fef2f2;
            border-left: 4px solid #ef4444;
        }

        .signal-group.inconclusive {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
        }

        .signal-group-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .signal-group.positive .signal-group-header {
            color: #16a34a;
        }

        .signal-group.risk .signal-group-header {
            color: #dc2626;
        }

        .signal-group.inconclusive .signal-group-header {
            color: #d97706;
        }

        .signal-group-header svg {
            width: 16px;
            height: 16px;
        }

        .signal-list {
            list-style: none;
        }

        .signal-list li {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            font-size: 0.85rem;
            color: #475569;
            margin-bottom: 0.5rem;
        }

        .signal-list li span {
            font-weight: 700;
        }

        .signal-group.positive .signal-list li span {
            color: #16a34a;
        }

        .signal-group.risk .signal-list li span {
            color: #dc2626;
        }

        .signal-group.inconclusive .signal-list li span {
            color: #d97706;
        }

        .signal-disclaimer {
            font-size: 0.75rem;
            color: #94a3b8;
            font-style: italic;
            margin-top: 0.5rem;
        }

        /* Scanned URL Box */
        .scanned-url-box {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
            border: 1px solid #e2e8f0;
        }

        .scanned-url-label {
            font-size: 0.7rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .scanned-url-text {
            font-size: 0.9rem;
            color: #1e293b;
            word-break: break-all;
        }

        /* Transparency Footer */
        .transparency-footer {
            text-align: center;
            padding: 1rem;
            border-top: 1px solid #e2e8f0;
            margin-bottom: 1.5rem;
        }

        .transparency-footer p {
            font-size: 0.8rem;
            color: #94a3b8;
            line-height: 1.6;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn-reset {
            flex: 1;
            padding: 1rem;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 500;
            color: #475569;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.2s;
        }

        .btn-reset:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }

        .btn-reset svg {
            width: 18px;
            height: 18px;
        }

        /* Error State */
        .error-section {
            display: none;
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 16px;
            padding: 1.5rem;
        }

        .error-section.active {
            display: block;
        }

        .error-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .error-icon {
            width: 40px;
            height: 40px;
            background: #ef4444;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .error-icon svg {
            width: 20px;
            height: 20px;
            color: white;
        }

        .error-content h3 {
            color: #dc2626;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .error-content p {
            color: #64748b;
            font-size: 0.9rem;
        }

        /* FAQ Modal */
        .faq-modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .faq-modal.active {
            display: flex;
        }

        .faq-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .faq-content {
            position: relative;
            background: #ffffff;
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        .faq-header {
            position: sticky;
            top: 0;
            background: #ffffff;
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .faq-header h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1e293b;
        }

        .faq-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            color: #64748b;
        }

        .faq-close:hover {
            color: #1e293b;
        }

        .faq-close svg {
            width: 24px;
            height: 24px;
        }

        .faq-body {
            padding: 1.5rem;
        }

        .faq-item {
            padding-bottom: 1.25rem;
            margin-bottom: 1.25rem;
            border-bottom: 1px solid #f1f5f9;
        }

        .faq-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .faq-item h3 {
            font-size: 0.95rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .faq-item p {
            font-size: 0.85rem;
            color: #64748b;
            line-height: 1.6;
        }

        .faq-footer {
            padding: 1rem 1.5rem;
            background: #f8fafc;
            border-top: 1px solid #f1f5f9;
        }

        .faq-footer p {
            font-size: 0.75rem;
            color: #94a3b8;
            text-align: center;
        }

        /* Page Footer */
        .page-footer {
            text-align: center;
            padding: 2rem;
            color: #94a3b8;
            font-size: 0.85rem;
        }

        .page-footer p {
            margin-bottom: 0.5rem;
        }

        .page-footer button {
            background: none;
            border: none;
            color: #4f46e5;
            font-size: 0.85rem;
            cursor: pointer;
            text-decoration: underline;
        }

        .page-footer button:hover {
            color: #7c3aed;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .nav-links {
                display: none;
            }

            .search-box {
                flex-direction: column;
            }

            .scan-btn {
                width: 100%;
                justify-content: center;
                margin: 0.5rem;
            }

            .verdict-card {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <a href="/" class="logo">
            <div class="logo-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
            </div>
            PhishGuard
        </a>

        <div class="nav-links">
            <a href="/" class="active">Scanner</a>
            <a href="/dashboard">Dashboard</a>
            <a href="/scan-history">Scan History</a>
            <a href="/threat-map">Threat Map</a>
            <a href="/settings">Settings</a>
        </div>

        <div class="nav-right">
            <button class="nav-icon" title="Notifications">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" />
                    <path d="M13.73 21a2 2 0 0 1-3.46 0" />
                </svg>
            </button>
            <div class="avatar">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                </svg>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <h1>Scan URLs for <span>Hidden Threats</span></h1>
        <p>AI-powered phishing detection with trusted domain protection. Analyze any URL in seconds.</p>

        <!-- Search Bar -->
        <div class="search-container">
            <form id="scanForm" class="search-box">
                <div class="search-input-wrapper">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10" />
                        <line x1="2" y1="12" x2="22" y2="12" />
                        <path
                            d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
                    </svg>
                    <input type="text" id="urlInput" class="search-input"
                        placeholder="Enter URL to scan (e.g., https://example.com)" autocomplete="off" required>
                </div>
                <button type="submit" id="scanBtn" class="scan-btn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                        <polyline points="9 12 11 14 15 10" />
                    </svg>
                    Scan URL
                </button>
            </form>
        </div>

        <div class="badges">
            <div class="badge green">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
                </svg>
                149 Trusted Domains
            </div>
            <div class="badge blue">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                </svg>
                Calibrated ML Model
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Loading State -->
        <div id="loadingState" class="loading-overlay">
            <div class="spinner-container">
                <div class="spinner"></div>
                <p id="scanStatus" class="loading-text">Checking trusted domains...</p>
                <p class="loading-subtext">Analyzing security indicators...</p>
            </div>
        </div>

        <!-- Result Section -->
        <div id="resultSection" class="result-section">
            <!-- Verdict Card -->
            <div id="verdictCard" class="verdict-card safe">
                <div id="verdictIcon" class="verdict-icon safe">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                        <polyline points="9 12 11 14 15 10" />
                    </svg>
                </div>
                <div class="verdict-content">
                    <h2 id="verdictText" class="verdict-text safe">SAFE TO GO</h2>
                    <p id="verdictSubtext" class="verdict-subtext">No significant phishing indicators detected</p>
                    <div id="trustedBadge" class="trusted-badge" style="display: none;">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z" />
                        </svg>
                        Trusted Domain
                    </div>
                </div>
            </div>

            <!-- Risk Assessment -->
            <div class="risk-card">
                <div class="risk-header">
                    <span class="risk-label">Risk Assessment</span>
                    <span id="riskValue" class="risk-value safe">0%</span>
                </div>
                <div class="risk-bar">
                    <div id="riskBar" class="risk-bar-fill safe" style="width: 0%"></div>
                </div>
                <p id="riskLevel" class="risk-level-text">Minimal risk - safe to proceed</p>
            </div>

            <!-- Incomplete Warning -->
            <div id="incompleteWarning" class="warning-box incomplete" style="display: none;">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" />
                </svg>
                <div class="warning-content">
                    <h4>Analysis Incomplete</h4>
                    <p>Some checks could not be completed. Results should be interpreted with caution.</p>
                </div>
            </div>

            <!-- Allowlist Override -->
            <div id="allowlistOverride" class="warning-box allowlist" style="display: none;">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z" />
                </svg>
                <div class="warning-content">
                    <h4>Trusted Domain</h4>
                    <p>This domain appears on a trusted allowlist. Risk signals are hidden and ML classification was
                        bypassed.</p>
                </div>
            </div>

            <!-- Signals Section -->
            <div class="signals-section">
                <div class="signals-header">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z" />
                    </svg>
                    <h3>Why This Result?</h3>
                </div>

                <div id="explanationSummary" class="signals-summary">
                    Analysis complete.
                </div>

                <!-- Positive Signals -->
                <div id="positiveSignals" class="signal-group positive" style="display: none;">
                    <div class="signal-group-header">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
                        </svg>
                        Positive Signals
                    </div>
                    <ul id="positiveSignalsList" class="signal-list"></ul>
                </div>

                <!-- Risk Signals -->
                <div id="riskSignals" class="signal-group risk" style="display: none;">
                    <div class="signal-group-header">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" />
                        </svg>
                        Risk Signals
                    </div>
                    <ul id="riskSignalsList" class="signal-list"></ul>
                </div>

                <!-- Inconclusive Checks -->
                <div id="inconclusiveChecks" class="signal-group inconclusive" style="display: none;">
                    <div class="signal-group-header">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" />
                        </svg>
                        Inconclusive Checks
                    </div>
                    <ul id="inconclusiveChecksList" class="signal-list"></ul>
                    <p class="signal-disclaimer">Some checks could not be completed due to network or access
                        limitations. This does NOT imply the URL is malicious.</p>
                </div>
            </div>

            <!-- Scanned URL -->
            <div class="scanned-url-box">
                <p class="scanned-url-label">Scanned URL</p>
                <p id="scannedUrl" class="scanned-url-text"></p>
            </div>

            <!-- Transparency Footer -->
            <div class="transparency-footer">
                <p>This analysis uses machine learning and heuristic checks. Some threats may not be detected. Always
                    exercise caution with unfamiliar URLs.</p>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button id="resetBtn" class="btn-reset">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M23 4v6h-6" />
                        <path d="M1 20v-6h6" />
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" />
                    </svg>
                    Scan Another URL
                </button>
            </div>
        </div>

        <!-- Error Section -->
        <div id="errorSection" class="error-section">
            <div class="error-header">
                <div class="error-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" />
                    </svg>
                </div>
                <div class="error-content">
                    <h3>Analysis Failed</h3>
                    <p id="errorMessage">An error occurred while analyzing the URL.</p>
                </div>
            </div>
            <button id="retryBtn" class="btn-reset">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M23 4v6h-6" />
                    <path d="M1 20v-6h6" />
                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" />
                </svg>
                Try Again
            </button>
        </div>
    </main>

    <!-- Page Footer -->
    <footer class="page-footer">
        <p>Powered by Calibrated ML | Trusted Domain Protection | Security-First Analysis</p>
        <button id="openFaqBtn">Learn More / FAQ</button>
    </footer>

    <!-- FAQ Modal -->
    <div id="faqModal" class="faq-modal">
        <div id="faqBackdrop" class="faq-backdrop"></div>
        <div class="faq-content">
            <div class="faq-header">
                <h2>Frequently Asked Questions</h2>
                <button id="closeFaqBtn" class="faq-close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>
            </div>
            <div id="faqContent" class="faq-body">
                <p>Loading...</p>
            </div>
            <div class="faq-footer">
                <p id="generalDisclaimer"></p>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const scanForm = document.getElementById('scanForm');
        const urlInput = document.getElementById('urlInput');
        const scanBtn = document.getElementById('scanBtn');
        const loadingState = document.getElementById('loadingState');
        const scanStatus = document.getElementById('scanStatus');
        const resultSection = document.getElementById('resultSection');
        const verdictCard = document.getElementById('verdictCard');
        const verdictIcon = document.getElementById('verdictIcon');
        const verdictText = document.getElementById('verdictText');
        const verdictSubtext = document.getElementById('verdictSubtext');
        const trustedBadge = document.getElementById('trustedBadge');
        const riskValue = document.getElementById('riskValue');
        const riskBar = document.getElementById('riskBar');
        const riskLevel = document.getElementById('riskLevel');
        const incompleteWarning = document.getElementById('incompleteWarning');
        const allowlistOverride = document.getElementById('allowlistOverride');
        const explanationSummary = document.getElementById('explanationSummary');
        const positiveSignals = document.getElementById('positiveSignals');
        const positiveSignalsList = document.getElementById('positiveSignalsList');
        const riskSignals = document.getElementById('riskSignals');
        const riskSignalsList = document.getElementById('riskSignalsList');
        const inconclusiveChecks = document.getElementById('inconclusiveChecks');
        const inconclusiveChecksList = document.getElementById('inconclusiveChecksList');
        const scannedUrl = document.getElementById('scannedUrl');
        const resetBtn = document.getElementById('resetBtn');
        const errorSection = document.getElementById('errorSection');
        const errorMessage = document.getElementById('errorMessage');
        const retryBtn = document.getElementById('retryBtn');

        // Status messages
        const statusMessages = [
            'Checking trusted domains...',
            'Extracting URL features...',
            'Analyzing security indicators...',
            'Running ML inference...',
            'Generating explanation...'
        ];

        let statusIndex = 0;
        let statusInterval;

        function startStatusAnimation() {
            statusIndex = 0;
            scanStatus.textContent = statusMessages[0];
            statusInterval = setInterval(() => {
                statusIndex = (statusIndex + 1) % statusMessages.length;
                scanStatus.textContent = statusMessages[statusIndex];
            }, 1000);
        }

        function stopStatusAnimation() {
            if (statusInterval) clearInterval(statusInterval);
        }

        function showLoading() {
            loadingState.classList.add('active');
            resultSection.classList.remove('active');
            errorSection.classList.remove('active');
            scanBtn.disabled = true;
            startStatusAnimation();
        }

        function hideLoading() {
            loadingState.classList.remove('active');
            scanBtn.disabled = false;
            stopStatusAnimation();
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function showResult(data) {
            hideLoading();
            resultSection.classList.add('active');

            const exp = data.explanation || {};
            const isAllowlistOverride = exp.allowlist_override === true || data.is_trusted_domain === true;
            const analysisComplete = exp.analysis_complete !== false;

            let verdict = data.verdict;
            let riskScore = data.risk_score || 0;

            // UX SAFETY: Never show PHISHING for trusted domains
            if (isAllowlistOverride && verdict === 'PHISHING') {
                verdict = 'SAFE';
            }

            // UX SAFETY: Cap risk to 30% for trusted domains
            if (isAllowlistOverride) {
                riskScore = Math.min(riskScore, 30);
            }

            // Update verdict styling
            const verdictClass = verdict === 'SAFE' ? 'safe' : verdict === 'SUSPICIOUS' ? 'suspicious' : 'phishing';

            verdictCard.className = 'verdict-card ' + verdictClass;
            verdictIcon.className = 'verdict-icon ' + verdictClass;
            verdictText.className = 'verdict-text ' + verdictClass;
            riskValue.className = 'risk-value ' + verdictClass;
            riskBar.className = 'risk-bar-fill ' + verdictClass;

            if (verdict === 'SAFE') {
                verdictIcon.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><polyline points="9 12 11 14 15 10"/></svg>';
                verdictText.textContent = 'SAFE TO GO';
                verdictSubtext.textContent = 'No significant phishing indicators detected';
            } else if (verdict === 'SUSPICIOUS') {
                verdictIcon.innerHTML = '<svg viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>';
                verdictText.textContent = 'SUSPICIOUS';
                verdictSubtext.textContent = 'Some concerning patterns detected - proceed with caution';
            } else {
                verdictIcon.innerHTML = '<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>';
                verdictText.textContent = 'PHISHING DETECTED';
                verdictSubtext.textContent = 'Multiple phishing indicators found - avoid this site';
            }

            // Trusted domain badge
            trustedBadge.style.display = isAllowlistOverride ? 'inline-flex' : 'none';

            // Risk score animation
            setTimeout(() => {
                riskBar.style.width = riskScore + '%';
                riskValue.textContent = riskScore.toFixed(1) + '%';
            }, 100);
            riskLevel.textContent = data.risk_level || '';

            // Warnings
            incompleteWarning.style.display = !analysisComplete ? 'flex' : 'none';
            allowlistOverride.style.display = isAllowlistOverride ? 'flex' : 'none';

            // Summary
            explanationSummary.textContent = exp.summary || 'Analysis complete.';

            // Positive Signals
            const positive = Array.isArray(exp.positive) ? exp.positive : [];
            if (positive.length > 0) {
                positiveSignals.style.display = 'block';
                positiveSignalsList.innerHTML = positive.slice(0, 5).map(s =>
                    `<li><span>+</span> ${escapeHtml(s)}</li>`
                ).join('');
            } else {
                positiveSignals.style.display = 'none';
            }

            // Risk Signals (never show for trusted domains)
            const risk = Array.isArray(exp.risk) ? exp.risk : [];
            if (risk.length > 0 && !isAllowlistOverride) {
                riskSignals.style.display = 'block';
                riskSignalsList.innerHTML = risk.slice(0, 5).map(s =>
                    `<li><span>!</span> ${escapeHtml(s)}</li>`
                ).join('');
            } else {
                riskSignals.style.display = 'none';
            }

            // Inconclusive Checks
            const inconclusive = Array.isArray(exp.inconclusive) ? exp.inconclusive : [];
            if (inconclusive.length > 0) {
                inconclusiveChecks.style.display = 'block';
                inconclusiveChecksList.innerHTML = inconclusive.map(s =>
                    `<li><span>?</span> ${escapeHtml(s)}</li>`
                ).join('');
            } else {
                inconclusiveChecks.style.display = 'none';
            }

            scannedUrl.textContent = data.url || '';
        }

        function showError(message) {
            hideLoading();
            errorSection.classList.add('active');
            errorMessage.textContent = message;
        }

        function resetForm() {
            resultSection.classList.remove('active');
            errorSection.classList.remove('active');
            riskBar.style.width = '0%';
            urlInput.value = '';
            urlInput.focus();
        }

        // Form submission
        scanForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const url = urlInput.value.trim();
            if (!url) return;

            showLoading();

            try {
                const response = await fetch('/scan', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url })
                });

                const data = await response.json();

                if (data.success) {
                    showResult(data);
                } else {
                    showError(data.error || 'Unknown error');
                }
            } catch (err) {
                showError('Network error. Please check your connection.');
            }
        });

        resetBtn.addEventListener('click', resetForm);
        retryBtn.addEventListener('click', resetForm);
        urlInput.focus();

        // FAQ Modal
        const faqModal = document.getElementById('faqModal');
        const faqBackdrop = document.getElementById('faqBackdrop');
        const faqContent = document.getElementById('faqContent');
        const generalDisclaimer = document.getElementById('generalDisclaimer');
        const openFaqBtn = document.getElementById('openFaqBtn');
        const closeFaqBtn = document.getElementById('closeFaqBtn');

        let userAnswersData = null;

        async function loadUserAnswers() {
            try {
                const response = await fetch('/api/user-answers');
                if (response.ok) {
                    userAnswersData = await response.json();
                }
            } catch (e) {
                console.warn('Could not load FAQ data');
            }
        }

        function renderFaqContent() {
            if (!userAnswersData || !userAnswersData.questions) {
                faqContent.innerHTML = '<p style="color: #64748b;">Could not load FAQ content.</p>';
                return;
            }

            const faqHtml = userAnswersData.questions
                .filter(q => q.display_context && q.display_context.includes('faq'))
                .map(q => `
                    <div class="faq-item">
                        <h3>${escapeHtml(q.question)}</h3>
                        <p>${escapeHtml(q.answer)}</p>
                    </div>
                `).join('');

            faqContent.innerHTML = faqHtml || '<p style="color: #64748b;">No FAQ items available.</p>';

            if (userAnswersData.disclaimers && userAnswersData.disclaimers.general) {
                generalDisclaimer.textContent = userAnswersData.disclaimers.general;
            }
        }

        function openFaqModal() {
            renderFaqContent();
            faqModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeFaqModal() {
            faqModal.classList.remove('active');
            document.body.style.overflow = '';
        }

        openFaqBtn.addEventListener('click', openFaqModal);
        closeFaqBtn.addEventListener('click', closeFaqModal);
        faqBackdrop.addEventListener('click', closeFaqModal);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && faqModal.classList.contains('active')) {
                closeFaqModal();
            }
        });

        loadUserAnswers();
    </script>
</body>

</html>